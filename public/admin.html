<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>DTE · Admin · Respostas</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <main class="container">
    <h1>Admin · Respostas por usuário</h1>

    <div class="card">
      <p class="scale-legend">
        Esta tela é visível apenas para administradores.
        <br/>
        <a href="/result.html" style="color:#a5b4fc;text-decoration:none;">Voltar</a> ·
        <a href="/aggregate.html" style="color:#a5b4fc;text-decoration:none;">Ver agregado</a> ·
        <a href="#" id="logout" style="color:#a5b4fc;text-decoration:none;">Sair</a>
      </p>
      <p class="scale-legend" id="status">Carregando...</p>
    </div>

    
    <div class="card">
      <h2>Gerar convite por link</h2>
      <p class="scale-legend">Gere um link para convidar respondentes. Você pode definir expiração e limite de usos (0 = ilimitado).</p>
      <div class="question-card">
        <p class="question-text">Expira em (dias, opcional)</p>
        <input id="inv-expires" type="number" min="1" step="1" placeholder="Ex: 7" style="width:100%;padding:10px;border-radius:10px;border:1px solid #1f2937;background:#020617;color:#e5e7eb;"/>
      </div>
      <div class="question-card">
        <p class="question-text">Máximo de usos (0 = ilimitado)</p>
        <input id="inv-max" type="number" min="0" step="1" value="0" style="width:100%;padding:10px;border-radius:10px;border:1px solid #1f2937;background:#020617;color:#e5e7eb;"/>
      </div>
      <button type="button" id="inv-generate">Gerar link</button>
      <p class="scale-legend" id="inv-msg"></p>
      <div id="inv-qr-wrap" style="display:none; text-align:center; padding:12px; border:1px solid #1f2937; border-radius:12px; background:#020617;">
  <img id="inv-qr" alt="QR Code do convite" style="max-width:260px;width:100%;height:auto;"/>
  <p class="scale-legend" style="margin-top:10px;">Aponte a câmera para abrir o convite.</p>
  <p class="scale-legend" id="inv-link-text" style="word-break:break-all;"></p>
</div>
<pre id="inv-link" style="white-space:pre-wrap;background:#020617;border:1px solid #1f2937;border-radius:12px;padding:12px;display:none;"></pre>

      <h3>Convites recentes</h3>
      <div id="invites"></div>
    </div>

    <div class="card">
      <h2>Usuários</h2>
      <div id="users"></div>
    </div>

    <div class="card" id="detail-card" style="display:none;">
      <h2>Detalhes</h2>
      <p class="scale-legend" id="detail-title"></p>
      <div class="results-grid">
        <div class="result-box">
          <div class="result-title">Segurança · Estirpe Pátria</div>
          <div>Média: <span id="d-score-M" class="result-value"></span></div>
          <div>Perfil: <span id="d-label-M"></span></div>
          <div>Participação: <span id="d-weight-M"></span></div>
        </div>
        <div class="result-box">
          <div class="result-title">Prosperidade · Ventos Áureo</div>
          <div>Média: <span id="d-score-C" class="result-value"></span></div>
          <div>Perfil: <span id="d-label-C"></span></div>
          <div>Participação: <span id="d-weight-C"></span></div>
        </div>
        <div class="result-box">
          <div class="result-title">Sentido · Sociedade da Fé</div>
          <div>Média: <span id="d-score-R" class="result-value"></span></div>
          <div>Perfil: <span id="d-label-R"></span></div>
          <div>Participação: <span id="d-weight-R"></span></div>
        </div>
      </div>

      <h3>Triângulo</h3>
      <canvas id="triangle-canvas" width="600" height="420"></canvas>

      <h3>Respostas brutas</h3>
      <pre id="raw" style="white-space:pre-wrap;background:#020617;border:1px solid #1f2937;border-radius:12px;padding:12px;"></pre>
    </div>
  </main>

  <script type="module" src="/js/admin.js"></script>
</body>
</html>
